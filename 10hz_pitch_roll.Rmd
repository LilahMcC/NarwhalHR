---
title: "10hz_pitch_roll"
author: "Lilah McCormick"
date: '2022-07-18'
output: 
  html_document:
    toc: yes
    toc_float: yes 
    theme: default 
    highlights: monotone
---
load libraries: 
```{r load libraries, echo = FALSE, message = FALSE}
library(tidyverse)
library(lubridate)
# Time for a utility script?
source("util.R")
```

Goal: Make a single dataframe with columns: DateTime, depth, pitch, roll at 10Hz frequency (10 rows per second)  
Steps:   
1. Downsample pitch/roll from 100 to 10 Hz  
1. Upsample depth from 1 to 10 Hz  
1. Calculate pitch and roll from acceleration values. 

Downsample pitch and roll:   
- Pipe acceleration  
- Use slice function (take every 10th point)   
- Pipe to mutate and call approx()  

Upsample depth:  
- Use approx ()  
- Parameters: x = DateTime (vector), y = depth (vector), xout = DateTime values that you want depth values for   (vector), $y.    

Calculate pitch and roll and mutate into dataframe   
- See existing .Rmd files.  

```{r read_into_wide,  echo = FALSE, message = FALSE}
acc_wide <- read_acc("HDI0_Asgeir.txt", 
                     "HDJ0_Asgeir.txt", 
                     "HDK0_Asgeir.txt", 
                     nrow = 200) %>% 
  mutate(anorm = anorm(cbind(acc_x, acc_y, acc_z)),
         pitch = pitch(acc_x, anorm),
         roll = roll(acc_y, acc_z))
```

```{r downsample acc to 10 Hz }
ten_hz <- acc_wide %>% 
  slice(seq(1, nrow(acc_wide), 10)) #extracts every 10th row 
```

```{r upsample depth to 10 Hz}
ten_hz_depth <- read_depth("Depth_Asgeir.txt")
ten_hz_first <- head(ten_hz_depth, n = 10) %>% 
  mutate(row_num = c(1:10))
```


```{r upsample depth to 10 Hz}
approx(ten_hz_first$row_num, ten_hz_first$Depth, xout = seq(from = 1, to = 10, .5), method = "linear")$y
```



